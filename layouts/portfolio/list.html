{{- define "main" }}

{{- /* Status label mapping */ -}}
{{- $statusLabels := dict "active" "Active" "completed" "Completed" "archived" "Archived" -}}

{{- /* Category label mapping */ -}}
{{- $categoryLabels := dict "research" "Research" "developer-tools" "Developer Tools" "open-source" "Open Source" -}}

<header class="page-header">
  {{- partial "breadcrumbs.html" . }}
  <h1>{{ .Title }}</h1>
  {{- with .Description }}
  <div class="post-description">{{ . | markdownify }}</div>
  {{- end }}
</header>

<div class="portfolio-intro" role="region" aria-label="Portfolio introduction">
  {{ .Content }}
</div>

{{- if .Pages }}
<section class="portfolio-projects" aria-labelledby="projects-heading">
  <h2 id="projects-heading" class="visually-hidden">Projects</h2>
  <div class="portfolio-grid" role="list">
    {{- range .Pages.ByWeight }}
    <article class="portfolio-card" role="listitem">
      {{- if .Params.cover.image }}
      <div class="portfolio-card-image">
        <img src="{{ .Params.cover.image }}" alt="" loading="lazy" aria-hidden="true">
      </div>
      {{- else }}
      <div class="portfolio-card-placeholder" aria-hidden="true">
        {{- partial "portfolio/icons/document.html" . }}
      </div>
      {{- end }}
      <div class="portfolio-card-content">
        {{- partial "portfolio/card-meta.html" (dict "page" . "statusLabels" $statusLabels "categoryLabels" $categoryLabels) }}
        <div class="portfolio-card-header">
          <h3>{{ .Title }}</h3>
        </div>
        {{- with .Params.tagline }}
        <p class="portfolio-tagline">{{ . }}</p>
        {{- end }}
        <div class="portfolio-card-body">{{ .Summary }}</div>
        {{- partial "portfolio/tech-tags.html" . }}
        {{- partial "portfolio/card-links.html" . }}
      </div>
    </article>
    {{- end }}
  </div>
</section>
{{- end }}

{{- end }}
